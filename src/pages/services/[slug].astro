---
import { getCollection, getEntry, render } from "astro:content";
import BlogPost from "../../layouts/BlogPost.astro";

export async function getStaticPaths() {
  const allServices = await getCollection(
    "services",
    ({ data }) => !data.draft,
  );

  return allServices
    .sort((a, b) => (b.data.order ?? 0) - (a.data.order ?? 0))
    .map(({ slug }) => ({ params: { slug } }));
}

const { slug } = Astro.params;
const entry = await getEntry("services", slug);
if (!entry) {
  throw new Error(`Case study not found: ${slug}`);
}

const { Content } = await render(entry);
---

<BlogPost {...entry.data} backUrl="services">
  <Content />
</BlogPost>
