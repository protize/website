---
export interface Props {
  href: string;
  text: string;
}

const { href, text } = Astro.props;

const BASE = import.meta.env.BASE_URL || "/";
const normalize = (p: string) => {
  let path = p || "/";
  path = path.replace(/index\.html$/i, "");
  if (BASE !== "/" && path.startsWith(BASE)) {
    path = path.slice(BASE.length - 1);
  }
  if (path.length > 1 && path.endsWith("/")) path = path.slice(0, -1);
  return path || "/";
};

const currentPath = normalize(Astro.url.pathname);
const targetPath = normalize(new URL(href, Astro.url).pathname);

const isActive =
  currentPath === targetPath ||
  (targetPath !== "/" && currentPath.startsWith(targetPath + "/"));
---

<li class="relative group">
  <a
    href={href}
    aria-current={isActive ? "page" : undefined}
    class={`inline-block py-1 text-base transition-colors duration-300 ease-out ${
      isActive
        ? "text-blue-700 font-bold"
        : "text-slate-700 font-normal hover:text-blue-700"
    }`}
  >
    {text}
  </a>

  <span
    class={`pointer-events-none absolute left-0 -bottom-0.5 h-0.5 w-full origin-left bg-blue-700 transition-transform duration-300 ease-out ${
      isActive ? "scale-x-100" : "scale-x-0 group-hover:scale-x-100"
    }`}></span>
</li>
