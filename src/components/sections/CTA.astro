---
import Container from "../shared/Container.astro";
import CtaButton from "../shared/CtaButton.astro";
import GradiantText from "../shared/GradiantText.astro";
import Paragraph from "../shared/Paragraph.astro";

export interface Props {
  className?: string;
}

const { className = "" } = Astro.props;
---

<section id="cta" class={`relative ${className}`}>
  <Container>
    <div
      id="cta-card"
      class="relative w-full overflow-hidden rounded-2xl bg-gradient-to-br from-blue-50 to-blue-100 py-12 md:py-16 px-6 md:px-10 shadow-lg text-center"
    >
      <div class="mx-auto max-w-2xl space-y-6 cta-reveal cta-content">
        <h1
          class="cta-reveal cta-title text-3xl sm:text-4xl md:text-5xl font-extrabold leading-tight text-gray-900"
          style="--delay: 80ms"
        >
          Ready to
          <GradiantText>Build</GradiantText> Something Exceptional with <GradiantText
            >Protize?</GradiantText
          >
        </h1>

        <Paragraph
          className="cta-reveal cta-text text-base md:text-lg text-gray-700 font-medium"
        >
          Accelerate your product journey with architecture-first execution,
          reliable delivery, and measurable results.
        </Paragraph>

        <div class="pt-6 cta-reveal cta-btn" style="--delay: 280ms">
          <a href="/contact-us"><CtaButton>Start Your Project</CtaButton></a>
        </div>
      </div>

      <div
        class="absolute -bottom-10 -right-10 h-40 w-40 bg-orange-200/50 rounded-full blur-2xl cta-blob cta-blob-a"
        aria-hidden="true"
      >
      </div>
      <div
        class="absolute -top-10 -left-10 h-32 w-32 bg-yellow-100/60 rounded-full blur-2xl cta-blob cta-blob-b"
        aria-hidden="true"
      >
      </div>
    </div>
  </Container>
</section>

<script>
  const cta = document.getElementById("cta-card");

  if (cta) {
    const prefersReducedMotion = window.matchMedia(
      "(prefers-reduced-motion: reduce)",
    ).matches;

    if (prefersReducedMotion) {
      cta.classList.add("cta-visible");
    } else {
      const observer = new IntersectionObserver(
        ([entry], obs) => {
          if (entry.isIntersecting) {
            cta.classList.add("cta-visible");
            obs.disconnect();
          }
        },
        { threshold: 0.25, rootMargin: "0px 0px -10% 0px" },
      );

      observer.observe(cta);
    }
  }
</script>

<style>
  /* Initial state */
  #cta-card .cta-reveal {
    opacity: 0;
    transform: translateY(18px);
    will-change: transform, opacity;
  }

  #cta-card .cta-content {
    transform: translateY(14px);
  }

  /* Enter animation */
  #cta-card.cta-visible .cta-reveal {
    animation: ctaFadeUp 0.7s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    animation-delay: var(--delay, 0ms);
  }

  @keyframes ctaFadeUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Soft floating blobs */
  #cta-card .cta-blob {
    animation: ctaFloat 7s ease-in-out infinite;
  }

  #cta-card .cta-blob-b {
    animation-delay: 1.2s;
  }

  @keyframes ctaFloat {
    0%,
    100% {
      transform: translateY(0px) scale(1);
    }
    50% {
      transform: translateY(-8px) scale(1.03);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    #cta-card .cta-reveal {
      opacity: 1 !important;
      transform: none !important;
      animation: none !important;
    }

    #cta-card .cta-blob {
      animation: none !important;
    }
  }
</style>
