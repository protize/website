---
// components/team-section/TeamGrid.astro
import type { ImageMetadata } from "astro";
import Container from "../../shared/Container.astro";

export type SocialLink = {
  label: "facebook" | "twitter" | "instagram" | "linkedin" | "github" | string;
  href: string;
};

export type TeamMember = {
  id?: string | number;
  name: string;
  role?: string;
  bio?: string;
  image: string | ImageMetadata;
  socials?: SocialLink[];
};

export interface Props {
  title?: string;
  subtitle?: string;
  description?: string;
  members: TeamMember[];
  className?: string;
}

const {
  title = "Our Creative Team",
  subtitle = "Our Team Members",
  description = "We are a multidisciplinary crew crafting products and delightful experiences.",
  members,
  className = "",
} = Astro.props;

const getImgSrc = (img: string | ImageMetadata) =>
  typeof img === "string" ? img : (img?.src ?? "");
---

<section class={`relative py-16 bg-orange-100 ${className}`}>
  <Container>
    <div class="mx-auto mb-14 max-w-2xl text-center">
      <p
        class="mb-2 text-sm font-semibold tracking-wide text-primary uppercase"
      >
        {subtitle}
      </p>
      <h2
        class="mb-3 text-3xl font-bold leading-tight text-gray-900 sm:text-4xl md:text-5xl"
      >
        {title}
      </h2>
      {
        description && (
          <p class="mx-auto max-w-3xl text-base text-gray-600 ">
            {description}
          </p>
        )
      }
    </div>

    <div
      class="team-grid grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"
    >
      {
        members.map((m, idx) => (
          <article
            class="card group relative overflow-hidden rounded-2xl border border-gray-200/60 bg-white p-6 shadow-sm backdrop-blur-sm transition-transform duration-300 hover:-translate-y-1 hover:rotate-[0.2deg] hover:shadow-xl"
            style={{ "--delay": `${idx * 80}ms` }}
          >
            {/* Glow ring on hover */}
            <div class="pointer-events-none absolute inset-0 rounded-2xl opacity-0 ring-2 ring-primary/50 ring-offset-2 ring-offset-transparent transition-opacity duration-300 group-hover:opacity-100" />

            {/* Avatar */}
            <div class="relative mx-auto mb-5 h-28 w-28">
              <img
                src={getImgSrc(m.image)}
                alt={m.name}
                class="h-28 w-28 rounded-full object-cover shadow-md"
                loading="lazy"
              />
              <span class="absolute -right-1 -top-1 inline-flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[10px] font-semibold text-white shadow">
                {(idx + 1).toString().padStart(2, "0")}
              </span>
            </div>

            {/* Text content */}
            <div class="text-center">
              <h3 class="text-lg font-semibold text-gray-900 ">{m.name}</h3>
              {m.role && (
                <p class="mt-0.5 text-sm font-medium text-primary">{m.role}</p>
              )}
              {m.bio && (
                <p class="mt-3 line-clamp-3 text-sm text-gray-600">{m.bio}</p>
              )}

              {/* {m.socials && m.socials.length > 0 && (
                <div class="mt-5 flex items-center justify-center gap-3 sm:gap-4">
                  {m.socials.map((s, i) => (
                    <a
                      href={s.href}
                      target="_blank"
                      rel="noreferrer"
                      aria-label={`${m.name} on ${s.label}`}
                      class="group relative inline-flex h-9 w-9 items-center justify-center rounded-full
               text-gray-500 dark:text-gray-400
               transition-all duration-200 ease-out
               hover:scale-110 active:scale-95
               hover:text-primary focus-visible:outline-none
               focus-visible:ring-2 focus-visible:ring-primary/60
               focus-visible:ring-offset-2 ring-offset-white dark:ring-offset-gray-950"
                    >
                      <span class="absolute inset-0 rounded-full bg-primary/10 opacity-0 transition-opacity duration-200 group-hover:opacity-100" />

                      {{
                        facebook: (
                          <svg
                            viewBox="0 0 24 24"
                            class="h-5 w-5 transition-transform duration-200 ease-out group-hover:rotate-3"
                            aria-hidden
                          >
                            <path
                              fill="currentColor"
                              d="M22 12.06C22 6.507 17.523 2 12 2S2 6.507 2 12.06C2 17.08 5.657 21.206 10.438 22v-7.02H7.898v-2.92h2.54V9.845c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.196 2.238.196v2.47h-1.26c-1.244 0-1.63.777-1.63 1.573v1.895h2.773l-.443 2.92h-2.33V22C18.343 21.206 22 17.08 22 12.06Z"
                            />
                          </svg>
                        ),
                        twitter: (
                          <svg
                            viewBox="0 0 24 24"
                            class="h-5 w-5 transition-transform duration-200 ease-out group-hover:rotate-3"
                            aria-hidden
                          >
                            <path
                              fill="currentColor"
                              d="M19.633 7.997c.013.176.013.353.013.53 0 5.414-4.123 11.657-11.657 11.657-2.316 0-4.467-.676-6.277-1.84.32.038.627.051.96.051a8.24 8.24 0 0 0 5.101-1.76 4.12 4.12 0 0 1-3.846-2.858c.25.038.5.064.763.064.365 0 .73-.051 1.071-.14A4.114 4.114 0 0 1 2.8 9.825v-.051c.55.307 1.199.49 1.886.515A4.106 4.106 0 0 1 2.88 6.5c0-.763.203-1.457.56-2.066A11.7 11.7 0 0 0 11.1 8.01a4.637 4.637 0 0 1-.102-.94 4.112 4.112 0 0 1 7.114-2.813 8.1 8.1 0 0 0 2.607-.992 4.128 4.128 0 0 1-1.804 2.27 8.2 8.2 0 0 0 2.368-.64 8.86 8.86 0 0 1-2.65 2.1Z"
                            />
                          </svg>
                        ),
                        instagram: (
                          <svg
                            viewBox="0 0 24 24"
                            class="h-5 w-5 transition-transform duration-200 ease-out group-hover:rotate-3"
                            aria-hidden
                          >
                            <path
                              fill="currentColor"
                              d="M12 2.163c3.204 0 3.584.012 4.85.07 1.17.054 1.97.24 2.428.403a4.9 4.9 0 0 1 1.772 1.153 4.9 4.9 0 0 1 1.153 1.772c.163.459.349 1.259.403 2.428.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.054 1.17-.24 1.97-.403 2.428a4.9 4.9 0 0 1-1.153 1.772 4.9 4.9 0 0 1-1.772 1.153c-.459.163-1.259.349-2.428.403-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.17-.054-1.97-.24-2.428-.403a4.9 4.9 0 0 1-1.772-1.153 4.9 4.9 0 0 1-1.153-1.772c-.163-.459-.349-1.259-.403-2.428C2.175 15.584 2.163 15.204 2.163 12s.012-3.584.07-4.85c.054-1.17.24-1.97.403-2.428a4.9 4.9 0 0 1 1.153-1.772A4.9 4.9 0 0 1 5.491 2.636c.459-.163 1.259-.349 2.428-.403C9.184 2.175 9.564 2.163 12 2.163Zm0 1.62c-3.152 0-3.523.012-4.763.069-1.022.047-1.577.217-1.945.362-.49.19-.84.416-1.209.785-.369.369-.595.719-.785 1.209-.145.368-.315.923-.362 1.945-.057 1.24-.069 1.61-.069 4.763s.012 3.523.069 4.763c.047 1.022.217 1.577.362 1.945.19.49.416.84.785 1.209.369.369.719.595 1.209.785.368.145.923.315 1.945.362 1.24.057 1.61.069 4.763.069s3.523-.012 4.763-.069c1.022-.047 1.577-.217 1.945-.362a3.28 3.28 0 0 0 1.209-.785 3.28 3.28 0 0 0 .785-1.209c.145-.368.315-.923.362-1.945.057-1.24.069-1.61.069-4.763s-.012-3.523-.069-4.763c-.047-1.022-.217-1.577-.362-1.945a3.28 3.28 0 0 0-.785-1.209 3.28 3.28 0 0 0-1.209-.785c-.368-.145-.923-.315-1.945-.362-1.24-.057-1.61-.069-4.763-.069Z"
                            />
                          </svg>
                        ),
                        linkedin: (
                          <svg
                            viewBox="0 0 24 24"
                            class="h-5 w-5 transition-transform duration-200 ease-out group-hover:rotate-3"
                            aria-hidden
                          >
                            <path
                              fill="currentColor"
                              d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1s2.48 1.12 2.48 2.5zM.5 8.5h4V23h-4V8.5zm7.5 0h3.84v1.98h.06c.53-1 1.82-2.06 3.75-2.06 4.01 0 4.75 2.64 4.75 6.07V23h-4v-6.5c0-1.55-.03-3.54-2.16-3.54-2.16 0-2.49 1.67-2.49 3.43V23h-4V8.5z"
                            />
                          </svg>
                        ),
                        github: (
                          <svg
                            viewBox="0 0 24 24"
                            class="h-5 w-5 transition-transform duration-200 ease-out group-hover:rotate-3"
                            aria-hidden
                          >
                            <path
                              fill="currentColor"
                              d="M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"
                            />
                          </svg>
                        ),
                      }[m.socials?.[i]?.label ?? ""] || (
                        <svg viewBox="0 0 24 24" class="h-5 w-5" aria-hidden>
                          <circle cx="12" cy="12" r="10" fill="currentColor" />
                        </svg>
                      )}
                    </a>
                  ))}
                </div>
              )} */}
            </div>

            {/* Subtle background dots */}
            <div class="pointer-events-none absolute -right-5 -top-5 -z-10 opacity-0 transition-opacity duration-300 group-hover:opacity-100">
              <svg
                width="90"
                height="90"
                viewBox="0 0 90 90"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                {Array.from({ length: 45 }).map((_, i) => (
                  <circle
                    cx={(i % 9) * 10 + 5}
                    cy={Math.floor(i / 9) * 10 + 5}
                    r="1.5"
                    fill="currentColor"
                    class="text-primary/30"
                  />
                ))}
              </svg>
            </div>
          </article>
        ))
      }
    </div>
  </Container>
</section>

<style>
  /* Entrance animation (replaces Framer Motion) */
  .team-grid .card {
    opacity: 0;
    transform: translateY(24px) scale(0.98);
    animation: fadeInUp 520ms cubic-bezier(0.2, 0.7, 0.2, 1) forwards;
    animation-delay: var(--delay, 0ms);
    will-change: transform, opacity;
  }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
</style>
